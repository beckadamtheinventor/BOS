;@DOES Return current keypress
;@OUTPUT A keypress
;@OUTPUT z if no key pressed
;@DESTROYS HL,BC,AF
sys_GetKey:
	call kb_Scan
	ld hl,$F50012
	ld b,7
	ld c,49
.scanloop:
	ld a,(hl)
	or a,a
	jr nz,.keyispressed
	inc hl
	inc hl
	ld a,c
	sub a,8
	ld c,a
	djnz .scanloop
	xor a,a
	jq .done
.keyispressed:
	ld b,8
.keybitloop:
	rrca
	jr c,.this
	inc c
	djnz .keybitloop
.this:
	ld a,c
.done:
	ld (last_keypress),a
	ret
